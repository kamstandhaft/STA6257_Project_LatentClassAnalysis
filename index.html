<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniel Martin, Kameron Standhaft, Esra Ari Acar">
<meta name="dcterms.date" content="2023-04-09">

<title>Latent Class Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">1. Introduction</a>
  <ul class="collapse">
  <li><a href="#lca-applications" id="toc-lca-applications" class="nav-link" data-scroll-target="#lca-applications">1.1 LCA Applications</a></li>
  <li><a href="#challenges-with-implementation-and-analysis-of-classes-using-lca" id="toc-challenges-with-implementation-and-analysis-of-classes-using-lca" class="nav-link" data-scroll-target="#challenges-with-implementation-and-analysis-of-classes-using-lca">1.2 Challenges with Implementation and Analysis of Classes using LCA</a></li>
  </ul></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">2. Methods</a></li>
  <li><a href="#analysis-and-results" id="toc-analysis-and-results" class="nav-link" data-scroll-target="#analysis-and-results">3. Analysis and Results</a>
  <ul class="collapse">
  <li><a href="#dataset-description" id="toc-dataset-description" class="nav-link" data-scroll-target="#dataset-description">3.1 Dataset Description</a></li>
  <li><a href="#load-necessary-packages" id="toc-load-necessary-packages" class="nav-link" data-scroll-target="#load-necessary-packages">3.2 Load Necessary Packages</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">3.2 Load Data</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">3.3 Data Preparation</a></li>
  </ul></li>
  <li><a href="#statistical-modeling" id="toc-statistical-modeling" class="nav-link" data-scroll-target="#statistical-modeling">4. Statistical Modeling</a>
  <ul class="collapse">
  <li><a href="#fitting-lca-models-with-of-classes-from-2-7" id="toc-fitting-lca-models-with-of-classes-from-2-7" class="nav-link" data-scroll-target="#fitting-lca-models-with-of-classes-from-2-7">4.1 Fitting LCA Models with # of Classes from 2-7</a></li>
  <li><a href="#model-comparison-statistics" id="toc-model-comparison-statistics" class="nav-link" data-scroll-target="#model-comparison-statistics">4.2 Model Comparison Statistics</a></li>
  <li><a href="#chosen-model-discussion-and-assessment" id="toc-chosen-model-discussion-and-assessment" class="nav-link" data-scroll-target="#chosen-model-discussion-and-assessment">4.3 Chosen Model Discussion and Assessment</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Latent Class Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Daniel Martin, Kameron Standhaft, Esra Ari Acar </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 9, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">1. Introduction</h2>
<p>Latent Class Analysis (LCA) is a statistical modeling method that can be utilized when it is believed that there may be unobserved subgroups (classes) among the individuals within a population. To identify these unobserved groups, LCA searches for and analyzes response patterns that may exist within categorical variables reported in the dataset (<a href="https://doi.org/10.1037/tps0000176">Nylund-Gibson &amp; Choi, 2018</a>). Latent Class Analysis is an example of a broader class of models called finite mixture models(FFM) (Grimm et al., 2021) that seek to identify and classify instances of variance within model parameters between groups within the data that have not been explicitly defined as groups by the attributes provided within the dataset itself. Ultimately, it is the “latent class prevalence” which is being estimated through a process in which the LCA function is estimating the probability that every entry being assessed from the dataset belongs within each of the classes generated by the model(<a href="https://www.ispor.org/docs/default-source/publications/value-outcomes-spotlight/november-december-2016/vos-primer-on-latent-class-analysis.pdf?sfvrsn=52b359b7_2">(Law &amp; Harrington, 2016)</a>).</p>
<p>LCA specifically makes the assumption that within the population potentially exists a finite number of unobserved subgroups, or latent classes, and that each individual belongs to only one of these classes (<a href="https://doi.org/10.1177/0095798420930932">Weller et al., 2020</a>). The overarching goal of LCA is to identify where a specific subset of classes exist within a group and estimate the proportions of those subset classes within the overall population. Additionally, LCA can be used to help determine if any relationships exist between the identified latent classes and any other observed variables within the dataset.</p>
<p>As computational efficiency has improved, Latent Class Analysis has seen an uptick in interest for researchers across a variety of fields with applications in science, business, and health (<a href="https://doi.org/10.3389/fpsyg.2019.01214">Petersen et al., 2019</a>). LCA is often most closely associated with identifying patterns of behavior or psychological characteristics that prove often otherwise difficult groups to identify(Kaplan et al., 2004).</p>
<section id="lca-applications" class="level3">
<h3 class="anchored" data-anchor-id="lca-applications">1.1 LCA Applications</h3>
<p>One frequent application of Latent Class Analysis (LCA) has been to utilize it to identify subgroups of individuals within a population that may have similar or associated symptoms or characteristics of a mental health profile (<a href="https://doi.org/10.3389/fpsyg.2019.01214">Petersen et al., 2019</a>) or when and which specific barriers may exist to receiving medical care (<a href="https://doi.org/10.1186/1472-6963-11-181">Thorpe et al., 2011</a>). LCA has also been used to identify when any subgroups of a population exist containing individuals that may have different risk factors or potential outcomes of a particular disease or disease pattern (<a href="https://doi.org/10.3389/fpsyg.2019.01214">Petersen et al., 2019</a>). Outside of health field applications, Latent Class Analysis can also be used in business and marketing to assess buying habits and even latent classes for groups with preferences for specific types of products (Kaplan et al., 2004).</p>
</section>
<section id="challenges-with-implementation-and-analysis-of-classes-using-lca" class="level3">
<h3 class="anchored" data-anchor-id="challenges-with-implementation-and-analysis-of-classes-using-lca">1.2 Challenges with Implementation and Analysis of Classes using LCA</h3>
<p>LCA has the ability to use mixture-modeling to distinguish and label instances of heterogeneity within a population and to identify subgroups of characteristics or individuals that may be more likely to exhibit those characteristics of heterogeneity (<a href="https://doi.org/10.1177/0095798420930932">Weller et al., 2020</a>). Identifying and labeling subgroups of a population that may not be explicitly obvious based upon its reported attributes has substantial application for helping to identify individuals within that population who may be at greater risk or likelihood for a particular outcome. This application can help drive execution of actions that may require intervention (<a href="https://doi.org/10.3389/fpsyg.2019.01214">Petersen et al., 2019</a>).</p>
<p>Latent class Analysis has application across a variety of fields, but there are also limitations that exist with to its use under certain circumstances that can prove challenging to its implementation. One of the major challenges that exist in any attempted implementation of this method, is being able to determine the appropriate number of latent classes. Doing so can prove time intensive and cumbersome, as the process can be somewhat subjective and often requires using a multi-step process to test multiple models and/or number of classes (<a href="https://doi.org/10.1080/10705511.2014.915181">Asparouhov &amp; Muthén, 2014</a>.</p>
<p>Interpretation of the classes themselves that were generated can also provide some significant challenge as it may require knowledge of not only the implementation methodology of the LCA upon the data but also requires that the analyst have access to background information about the data attributes and context (<a href="https://doi.org/10.1177/0095798420930932">Weller et al., 2020</a>). Though a class may be correctly identified, if the researcher/analyst does not correctly identify what is heterogenous about that class, it can lead to improper naming and assumptions about the defining characteristics of the members of that class for analysis (<a href="https://doi.org/10.1177/0095798420930932">Weller et al., 2020</a>).</p>
</section>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">2. Methods</h2>
<p>The general steps to use latent class analysis are as follows:</p>
<p>1.Identify the research question and define the variables Define the categorical variables that will be used in the analysis</p>
<p>2.Select the appropriate software: In this project R Studio will be used for the LCA</p>
<p>3.Determine the number of latent classes</p>
<p>4.Estimate the model: Estimate the model parameters using maximum likelihood estimation or Bayesian estimation</p>
<p>5.Evaluate the model: After estimating the model, evaluate its fit using goodness-of-fit statistics such as the likelihood ratio test, Akaike Information Criterion (AIC), and Bayesian Information Criterion (BIC). If our model fits well, interpret the results and report the estimated probabilities of individuals belonging to each class.</p>
<p>6.Conduct sensitivity analysis: Finally, conduct sensitivity analyses to test the robustness of the results and evaluate the stability of the estimated probabilities across different subgroups or samples.</p>
</section>
<section id="analysis-and-results" class="level2">
<h2 class="anchored" data-anchor-id="analysis-and-results">3. Analysis and Results</h2>
<section id="dataset-description" class="level3">
<h3 class="anchored" data-anchor-id="dataset-description">3.1 Dataset Description</h3>
<p>For the purpose of this paper, we are using a dataset from Kaggle called Zoo Animals (https://www.kaggle.com/datasets/ulrikthygepedersen/zoo-animals). There are 101 entries and a total of 18 variables in this dataset.The variables give information about the physical attributes of each of the animals, such as if they have hair, if they have teeth, if they lay eggs, etc. Of the 18 variables, 15 of them are binary variables and one of them is discrete. This majority of binary variables is why we chose this dataset for Latent Class Analysis.</p>
<p>The variable that we are concerned with the most is the “type” variable. This variable has 7 categories: mammals, fish, birds, insects, reptiles, invertebrates, amphibians. Of the 101 entries, 42 are mammals (41.58%), 21 are birds (20.79%), 14 are fish (13.86%), 11 are invertebrates (10.89%), 8 are insects (7.92%), 6 are reptiles (5.94%), and 5 are amphibians (4.95%).</p>
<p>Among other variables, we will be removing the “type” variable from the dataset. Latent Class Analysis will be utilized to ascertain whether the groups identified by this method correspond to the seven animal types.</p>
<p><strong>Variables considered in LCA Analysis:</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(formattable)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>tab_lca_var <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">var_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">'hair'</span>, <span class="st">'feathers'</span>,<span class="st">'eggs'</span>,<span class="st">'milk'</span>,<span class="st">'airborne'</span>,<span class="st">'aquatic'</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">'predator'</span>,<span class="st">'toothed'</span>,<span class="st">'backbone'</span>,<span class="st">'breathes'</span>,<span class="st">'venomous'</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">'fins'</span>,<span class="st">'tail'</span>,<span class="st">'has_legs'</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>   <span class="at">Variable_Description =</span> <span class="fu">c</span>(<span class="st">'Has hair?'</span>,<span class="st">'has feathers?'</span>,<span class="st">'Lays eggs?'</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                           <span class="st">'Produces milk?'</span>,<span class="st">'Can fly?'</span>,<span class="st">'Can swim?'</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                           <span class="st">'Is a predator?'</span>,<span class="st">'Has teeth?'</span>,<span class="st">'Has a backbone?'</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                           <span class="st">'Animal breathes?'</span>,<span class="st">'Has venom?'</span>,<span class="st">'Has fins?'</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                           <span class="st">'Has a tail?'</span>,<span class="st">'Has legs?'</span>))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">formattable</span>(tab_lca_var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
var_num
</th>
<th style="text-align:right;">
Variable
</th>
<th style="text-align:right;">
Variable_Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
hair
</td>
<td style="text-align:right;">
Has hair?
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
feathers
</td>
<td style="text-align:right;">
has feathers?
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
eggs
</td>
<td style="text-align:right;">
Lays eggs?
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
milk
</td>
<td style="text-align:right;">
Produces milk?
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
airborne
</td>
<td style="text-align:right;">
Can fly?
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
aquatic
</td>
<td style="text-align:right;">
Can swim?
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
predator
</td>
<td style="text-align:right;">
Is a predator?
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
toothed
</td>
<td style="text-align:right;">
Has teeth?
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
backbone
</td>
<td style="text-align:right;">
Has a backbone?
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
breathes
</td>
<td style="text-align:right;">
Animal breathes?
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
venomous
</td>
<td style="text-align:right;">
Has venom?
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
fins
</td>
<td style="text-align:right;">
Has fins?
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
tail
</td>
<td style="text-align:right;">
Has a tail?
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
has_legs
</td>
<td style="text-align:right;">
Has legs?
</td>
</tr>
</tbody>

</table>
</div>
</div>
<p><strong>Variables in original dataset, but not used in LCA models:</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tab_nonlca_var <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">var_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">'animal'</span>, <span class="st">'domestic'</span>,<span class="st">'catsize'</span>,<span class="st">'type'</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">Variable_Description =</span> <span class="fu">c</span>(<span class="st">'Animal Name'</span>,<span class="st">'Commonly domesticated?'</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'About the size of a cat?'</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                           <span class="st">'Animal Classification'</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">formattable</span>(tab_nonlca_var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
var_num
</th>
<th style="text-align:right;">
Variable
</th>
<th style="text-align:right;">
Variable_Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
animal
</td>
<td style="text-align:right;">
Animal Name
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
domestic
</td>
<td style="text-align:right;">
Commonly domesticated?
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
catsize
</td>
<td style="text-align:right;">
About the size of a cat?
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
type
</td>
<td style="text-align:right;">
Animal Classification
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="load-necessary-packages" class="level3">
<h3 class="anchored" data-anchor-id="load-necessary-packages">3.2 Load Necessary Packages</h3>
<p>When the data is first loaded, with each categorical variable, there is an apostrophe and a “b” before each word and at the end, there is an apostrophe. The data were cleaned into the file Zoo_clean with these extra characters removed leaving only “TRUE” &amp; “FALSE”.</p>
<p><strong>All Necessary Libraries are loaded here:</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loading packages </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poLCA)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">3.2 Load Data</h3>
<p>Below is where we import the cleaned dataset without the apostrophes or the “b”s.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Zoo_clean<span class="ot">&lt;-</span> (<span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/kamstandhaft/STA6257_Project_LatentClassAnalysis/main/Zoo_clean.csv"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>new_zoo <span class="ot">&lt;-</span> Zoo_clean <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">animal=</span><span class="cn">NULL</span>, <span class="at">domestic=</span><span class="cn">NULL</span>, <span class="at">catsize=</span><span class="cn">NULL</span>, <span class="at">type=</span><span class="cn">NULL</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(new_zoo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation">3.3 Data Preparation</h3>
<p>As mentioned above, we will be removing the “type” variable from the dataset with the goal of trying to replicate this level of classification through the latent class detection. The identifier variable “animal” will also be removed. Finally, we only want objective binary variables in our dataset, so we will also be removing “catsize” and “domestic” from the dataset, and transforming legs (denoting the number of legs a creature has) to has_legs (a binary operator indicating whether any legs are present or not).</p>
<p>We will be using the poLCA function from the poLCA package library, which requires an input of positive integer values &lt;=1. As such, we transformed our dataset from logical operators TRUE/FALSE to binary integers 0/1. But as poLCA function cannot accept “0” as a value, we further transformed the data by incrementing all values by 1, wherein “FALSE” is represented by “1”, and “TRUE” is represented by “2”.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding attribute has_legs to denote whether the animal has a leg count &gt;0</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>new_zoo <span class="ot">&lt;-</span> Zoo_clean <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">has_legs =</span> <span class="fu">ifelse</span>(legs <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing the non-binary integer representing the number of legs an animal has</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>new_zoo <span class="ot">&lt;-</span> new_zoo <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">legs =</span> <span class="cn">NULL</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Transforming has_legs to a logical operator to match the rest of the dataset </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        to be used in assessment</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>new_zoo<span class="sc">$</span>has_legs <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(new_zoo<span class="sc">$</span>has_legs)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a 14-variable subset of the 18-variable dataset with "animal", </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#       "domestic", "catsize", and "type" removed</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>new_zoo_subset <span class="ot">&lt;-</span> new_zoo <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">animal=</span><span class="cn">NULL</span>, <span class="at">domestic=</span><span class="cn">NULL</span>, </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">catsize=</span><span class="cn">NULL</span>, <span class="at">type=</span><span class="cn">NULL</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a dataset where the binary data is represented by </span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#       integers "0" for "FALSE" or "1" for "TRUE"</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>new_zoo_int <span class="ot">&lt;-</span> new_zoo_subset <span class="sc">%&gt;%</span> <span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">as.integer</span>(.))</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a dataset where the binary data is represented by </span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#        integers "1" for "FALSE" or "2" for "TRUE"</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>new_zoo_int_1 <span class="ot">&lt;-</span> new_zoo_int <span class="sc">%&gt;%</span> <span class="fu">mutate_all</span>(<span class="sc">~</span>. <span class="sc">+</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="statistical-modeling" class="level2">
<h2 class="anchored" data-anchor-id="statistical-modeling">4. Statistical Modeling</h2>
<p>Below we use the cbind function used to bind Columns being used in LCA</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cbind function used to bind Columns being used in LCA</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>lca_bind <span class="ot">&lt;-</span>  <span class="fu">cbind</span>(hair, feathers, eggs, milk, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                   airborne, aquatic, predator, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                   toothed, backbone, breathes, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                   venomous, fins, tail, has_legs) <span class="sc">~</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="fitting-lca-models-with-of-classes-from-2-7" class="level3">
<h3 class="anchored" data-anchor-id="fitting-lca-models-with-of-classes-from-2-7">4.1 Fitting LCA Models with # of Classes from 2-7</h3>
<p>Fitting a 2-class LCA Model</p>
<p>For the 2-class model, we have selected to display the output of the poLCA model results using the [verbose = TRUE] option.</p>
<p>For each variable, this indicates the percentage of “TRUE” &amp; “FALSE” values. These are represented graphically for the remainder of the models.</p>
<p>We chose to assess up to 7-class models because the original # of classifications was 7 “types”.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting a 2-class LCA Model</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>lca_fit2 <span class="ot">&lt;-</span> <span class="fu">poLCA</span>(lca_bind, <span class="at">data =</span> new_zoo_int_1, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nclass =</span> <span class="dv">2</span>, <span class="at">graphs =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">nrep=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model 1: llik = -652.6443 ... best llik = -652.6443
Model 2: llik = -652.6443 ... best llik = -652.6443
Model 3: llik = -691.0384 ... best llik = -652.6443
Model 4: llik = -680.9235 ... best llik = -652.6443
Model 5: llik = -609.2337 ... best llik = -609.2337
Model 6: llik = -609.2337 ... best llik = -609.2337
Model 7: llik = -609.2559 ... best llik = -609.2337
Model 8: llik = -609.2559 ... best llik = -609.2337
Model 9: llik = -695.5513 ... best llik = -609.2337
Model 10: llik = -695.5513 ... best llik = -609.2337
Model 11: llik = -652.6443 ... best llik = -609.2337
Model 12: llik = -609.2559 ... best llik = -609.2337
Model 13: llik = -695.5513 ... best llik = -609.2337
Model 14: llik = -680.9235 ... best llik = -609.2337
Model 15: llik = -609.2337 ... best llik = -609.2337
Model 16: llik = -680.9235 ... best llik = -609.2337
Model 17: llik = -689.5641 ... best llik = -609.2337
Model 18: llik = -609.2559 ... best llik = -609.2337
Model 19: llik = -652.6443 ... best llik = -609.2337
Model 20: llik = -680.9235 ... best llik = -609.2337
Model 21: llik = -690.4955 ... best llik = -609.2337
Model 22: llik = -609.2337 ... best llik = -609.2337
Model 23: llik = -609.2559 ... best llik = -609.2337
Model 24: llik = -652.6443 ... best llik = -609.2337
Model 25: llik = -690.4955 ... best llik = -609.2337
Model 26: llik = -609.2559 ... best llik = -609.2337
Model 27: llik = -695.5513 ... best llik = -609.2337
Model 28: llik = -608.5398 ... best llik = -608.5398
Model 29: llik = -609.2559 ... best llik = -608.5398
Model 30: llik = -609.2559 ... best llik = -608.5398
Model 31: llik = -652.6443 ... best llik = -608.5398
Model 32: llik = -609.2337 ... best llik = -608.5398
Model 33: llik = -680.9235 ... best llik = -608.5398
Model 34: llik = -609.2337 ... best llik = -608.5398
Model 35: llik = -652.6443 ... best llik = -608.5398
Model 36: llik = -609.2337 ... best llik = -608.5398
Model 37: llik = -609.2559 ... best llik = -608.5398
Model 38: llik = -652.6443 ... best llik = -608.5398
Model 39: llik = -652.6443 ... best llik = -608.5398
Model 40: llik = -695.5513 ... best llik = -608.5398
Model 41: llik = -609.2559 ... best llik = -608.5398
Model 42: llik = -680.9235 ... best llik = -608.5398
Model 43: llik = -680.9235 ... best llik = -608.5398
Model 44: llik = -610.8821 ... best llik = -608.5398
Model 45: llik = -609.2559 ... best llik = -608.5398
Model 46: llik = -680.9235 ... best llik = -608.5398
Model 47: llik = -652.6443 ... best llik = -608.5398
Model 48: llik = -680.9235 ... best llik = -608.5398
Model 49: llik = -609.2337 ... best llik = -608.5398
Model 50: llik = -609.2559 ... best llik = -608.5398
Model 51: llik = -609.2337 ... best llik = -608.5398
Model 52: llik = -652.6443 ... best llik = -608.5398
Model 53: llik = -652.6443 ... best llik = -608.5398
Model 54: llik = -680.9235 ... best llik = -608.5398
Model 55: llik = -691.0384 ... best llik = -608.5398
Model 56: llik = -609.2337 ... best llik = -608.5398
Model 57: llik = -695.5513 ... best llik = -608.5398
Model 58: llik = -680.9235 ... best llik = -608.5398
Model 59: llik = -652.6443 ... best llik = -608.5398
Model 60: llik = -652.6443 ... best llik = -608.5398
Model 61: llik = -680.9235 ... best llik = -608.5398
Model 62: llik = -609.2559 ... best llik = -608.5398
Model 63: llik = -720.7657 ... best llik = -608.5398
Model 64: llik = -652.6443 ... best llik = -608.5398
Model 65: llik = -608.5398 ... best llik = -608.5398
Model 66: llik = -609.2559 ... best llik = -608.5398
Model 67: llik = -609.2559 ... best llik = -608.5398
Model 68: llik = -609.2337 ... best llik = -608.5398
Model 69: llik = -609.2559 ... best llik = -608.5398
Model 70: llik = -608.5398 ... best llik = -608.5398
Model 71: llik = -680.9235 ... best llik = -608.5398
Model 72: llik = -652.6443 ... best llik = -608.5398
Model 73: llik = -609.2559 ... best llik = -608.5398
Model 74: llik = -609.2559 ... best llik = -608.5398
Model 75: llik = -652.6443 ... best llik = -608.5398
Model 76: llik = -720.7657 ... best llik = -608.5398
Model 77: llik = -609.2559 ... best llik = -608.5398
Model 78: llik = -652.6443 ... best llik = -608.5398
Model 79: llik = -609.2337 ... best llik = -608.5398
Model 80: llik = -609.2559 ... best llik = -608.5398
Model 81: llik = -609.2337 ... best llik = -608.5398
Model 82: llik = -680.9235 ... best llik = -608.5398
Model 83: llik = -695.5513 ... best llik = -608.5398
Model 84: llik = -680.9235 ... best llik = -608.5398
Model 85: llik = -680.9235 ... best llik = -608.5398
Model 86: llik = -609.2337 ... best llik = -608.5398
Model 87: llik = -652.6443 ... best llik = -608.5398
Model 88: llik = -652.6443 ... best llik = -608.5398
Model 89: llik = -680.9235 ... best llik = -608.5398
Model 90: llik = -695.5513 ... best llik = -608.5398
Model 91: llik = -652.6443 ... best llik = -608.5398
Model 92: llik = -609.2559 ... best llik = -608.5398
Model 93: llik = -609.2337 ... best llik = -608.5398
Model 94: llik = -652.6443 ... best llik = -608.5398
Model 95: llik = -680.9235 ... best llik = -608.5398
Model 96: llik = -680.9235 ... best llik = -608.5398
Model 97: llik = -683.0577 ... best llik = -608.5398
Model 98: llik = -680.9235 ... best llik = -608.5398
Model 99: llik = -652.6443 ... best llik = -608.5398
Model 100: llik = -609.2559 ... best llik = -608.5398</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Conditional item response (column) probabilities,
 by outcome variable, for each class (row) 
 
$hair
           Pr(1)  Pr(2)
class 1:  0.0483 0.9517
class 2:  0.9181 0.0819

$feathers
           Pr(1)  Pr(2)
class 1:  1.0000 0.0000
class 2:  0.6725 0.3275

$eggs
          Pr(1) Pr(2)
class 1:  1.000 0.000
class 2:  0.034 0.966

$milk
           Pr(1)  Pr(2)
class 1:  0.0000 1.0000
class 2:  0.9824 0.0176

$airborne
           Pr(1)  Pr(2)
class 1:  0.9499 0.0501
class 2:  0.6398 0.3602

$aquatic
           Pr(1)  Pr(2)
class 1:  0.8766 0.1234
class 2:  0.4912 0.5088

$predator
           Pr(1)  Pr(2)
class 1:  0.4759 0.5241
class 2:  0.4257 0.5743

$toothed
           Pr(1)  Pr(2)
class 1:  0.0000 1.0000
class 2:  0.6549 0.3451

$backbone
           Pr(1)  Pr(2)
class 1:  0.0000 1.0000
class 2:  0.2947 0.7053

$breathes
           Pr(1)  Pr(2)
class 1:  0.0000 1.0000
class 2:  0.3438 0.6562

$venomous
          Pr(1) Pr(2)
class 1:  1.000 0.000
class 2:  0.869 0.131

$fins
           Pr(1)  Pr(2)
class 1:  0.9017 0.0983
class 2:  0.7859 0.2141

$tail
           Pr(1)  Pr(2)
class 1:  0.1503 0.8497
class 2:  0.3275 0.6725

$has_legs
           Pr(1)  Pr(2)
class 1:  0.0733 0.9267
class 2:  0.3287 0.6713

Estimated class population shares 
 0.3953 0.6047 
 
Predicted class memberships (by modal posterior prob.) 
 0.396 0.604 
 
========================================================= 
Fit for 2 latent classes: 
========================================================= 
number of observations: 101 
number of estimated parameters: 29 
residual degrees of freedom: 72 
maximum log-likelihood: -608.5398 
 
AIC(2): 1275.08
BIC(2): 1350.918
G^2(2): 571.2106 (Likelihood ratio/deviance statistic) 
X^2(2): 21906.55 (Chi-square goodness of fit) 
 </code></pre>
</div>
</div>
<p>Fitting a 3-class LCA Model</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting a 3-class LCA Model</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>lca_fit3 <span class="ot">&lt;-</span> <span class="fu">poLCA</span>(lca_bind, <span class="at">data =</span> new_zoo_int_1, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nclass =</span> <span class="dv">3</span>, <span class="at">graphs =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">nrep=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Fitting a 4-class LCA Model</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>lca_fit4 <span class="ot">&lt;-</span> <span class="fu">poLCA</span>(lca_bind, <span class="at">data =</span> new_zoo_int_1, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nclass =</span> <span class="dv">4</span>, <span class="at">graphs =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">nrep=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Fitting a 5-class LCA Model</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>lca_fit5 <span class="ot">&lt;-</span> <span class="fu">poLCA</span>(lca_bind, <span class="at">data =</span> new_zoo_int_1, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nclass =</span> <span class="dv">5</span>, <span class="at">graphs =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">nrep=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Fitting a 6-class LCA Model</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>lca_fit6 <span class="ot">&lt;-</span> <span class="fu">poLCA</span>(lca_bind, <span class="at">data =</span> new_zoo_int_1, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nclass =</span> <span class="dv">6</span>, <span class="at">graphs =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">nrep=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Fitting a 7-class LCA Model</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>lca_fit7 <span class="ot">&lt;-</span> <span class="fu">poLCA</span>(lca_bind, <span class="at">data =</span> new_zoo_int_1, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nclass =</span> <span class="dv">7</span>, <span class="at">graphs =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">nrep=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="model-comparison-statistics" class="level3">
<h3 class="anchored" data-anchor-id="model-comparison-statistics">4.2 Model Comparison Statistics</h3>
<p>Arguably the model difficult part of using Latent Class Analysis is determining the correct number of classes to use to properly model the data. There are a number of statistics that help to indicate fit quality for each model, which we go through below to help select the correct number of classes for a good model.</p>
<p><strong>As a note</strong>: For each of these models, we are running 100 repetitions, and the criteria for which the best model is chosen is using the lowest BIC. The models and fit statistics can vary slightly through each run, even with 100 repetitions.</p>
<p>To compare these models, we will be primarily looking at the Akaike Information Criterion (AIC), the Bayesian Information Criterion (BIC), and the Chi-square goodness of fit statistic (X^2).</p>
<p>A lower value for the AIC and BIC values as well as the (X^2), indicate that the model is a better fit for the data.</p>
<p>As illustrated in the figure below,the 5-class, 6-class, and 7-class models all have substantially lower values for these statistical metrics than for the 2-class, 3-class, and 4-class models. It is worth noting however, that the 7-class model posts an alert indicating that the number of parameters estimated exceeds the number of observations, which effectively provides a negative residual Degree of Freedom (DoF). For this reason, we can eliminate the 7-class model.</p>
<p>The 5-class model has a better fit according to the BIC(1177) values compared to the 6-class model BIC(1199), but the AIC for the 6-class model (966) is slightly better than the 5-class model AIC(983).</p>
<p>The Chi-square goodness of fit statistic (X^2) for the 5-class model(1858) is better however than the (X^2) for the 6-class model(2283). Without a clearly better model between these two, we can further compare their entropy (see below).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/Model_comparison.PNG" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Model Comparison</figcaption><p></p>
</figure>
</div>
<p>The entropy of a model speaks to how well the classes are separated with a higher entropy value indicating a likely increase in the separation of classes.</p>
<p>As we see below, the 5-class model has a slightly higher entropy value than the 6-class model implying a slightly higher separability of classes. With AIC, BIC, and entropy in favor of the 5-class model, we select this model to use to assess and illustrate the classification schema that LCA uses to classify the dataset.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poLCA)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(formattable)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>lca_fit5.ent <span class="ot">&lt;-</span> <span class="fu">poLCA.entropy</span>(lca_fit5)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>lca_fit6.ent <span class="ot">&lt;-</span> <span class="fu">poLCA.entropy</span>(lca_fit6)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>tab_lca_entropy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">var_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>   <span class="at">Model_Class_Number =</span> <span class="fu">c</span>(<span class="st">'5-Class Model'</span>, <span class="st">'6-Class Model'</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>   <span class="at">Entropy =</span> <span class="fu">c</span>(lca_fit5.ent,lca_fit6.ent))</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">formattable</span>(tab_lca_entropy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
var_num
</th>
<th style="text-align:right;">
Model_Class_Number
</th>
<th style="text-align:right;">
Entropy
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5-Class Model
</td>
<td style="text-align:right;">
4.137245
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6-Class Model
</td>
<td style="text-align:right;">
3.905345
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="chosen-model-discussion-and-assessment" class="level3">
<h3 class="anchored" data-anchor-id="chosen-model-discussion-and-assessment">4.3 Chosen Model Discussion and Assessment</h3>
<p>With the better BIC, GoF(X^2), and Entropy value, we selected the 5-Class model as our preferred model.</p>
<p>The graph below shows along the x-axis, the proportions of the total dataset population that were classified into each of the 5-class of these model.</p>
<p>Class 1 - 12.85% Class 2 - 20.78% Class 3 - 35.46% Class 4 - 13.09% Class 5 - 17.82%</p>
<p><img src="index_files/figure-html/5_class_Model.png" class="img-fluid" alt="Figure 4.3.1 5-Class Model"> Under a normal research environment, we would not have the true classifications to compare these classes to against their predicted counterparts. But as we chose a dataset for which we could remove classification values and have the LCA models assess the attributes of the members, we designed the experiment to illustrate how Latent Class Analysis predicts which class a member should belong to, and can compare these to against a real classification schema.</p>
<p>For the purposes of these figures, we filtered selections based on whether the attributes had above ~70% likelihood of being members in the class according to the model. By doing so, there is the potential for overlap with certain member showing in more than one class, but with that in mind, this approach has the benefit of showing how potentially effective LCA can be at detecting these latent groups.</p>
<p>Class 1 which is estimated to contain ~12.85% of the population predicts its members to have eggs, aquatic, toothed, backbone, fins, tail. We filtered the cleaned new_zoo dataset for these attributes, and noted that all members were classified as type “fish” in the original dataset.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/fish.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure 4.3.2 Class 1 - 12.85% of the Population</figcaption><p></p>
</figure>
</div>
<p>Class 2 which is estimated to contain ~20.78% of the population predicts its members to have feathers, eggs, backbone, breathes, tail, has_legs. We filtered the cleaned new_zoo dataset for these attributes, and noted that all members were classified as type “bird” in the original dataset.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/bird.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure 4.3.3 Class 2 - 20.78% of the Population</figcaption><p></p>
</figure>
</div>
<p>Class 3 which. as the largest class, is estimated to contain ~35.46% of the population predicts its members to have hair, toothed, backbone, breathes, tail, has_legs. We filtered the cleaned new_zoo dataset for these attributes, and noted that all members were classified as type “mammal” in the original dataset. (There are additional members not pictures in the screenshot due to the size of the class).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/mammal.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure 4.3.4 Class 3 - 35.46% of the Population</figcaption><p></p>
</figure>
</div>
<p>Class 4 which is estimated to contain ~13.09% of the population becomes less homogenous. The original classification schema of “type” had 7 unique values, which implies that with a 5-class model, overlap is inevitable. This is only visible due to the fact that we have the original data for “type” for illustration purposes, which is unlikely to be the case in research data.This class’ members ar predicted to have aquatic, predator, toothed, backbone, breathes, tail. We filtered the cleaned new_zoo dataset for these attributes. The resulting filter only yielded 5 members, which are mostly aquatic mammals and a single amphibian.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/aquatic_mammal.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure 4.3.5 Class 4 - 13.09% of the Population</figcaption><p></p>
</figure>
</div>
<p>Class 5 was our final class, and estimated to contain 17.09% of the population. This class is the least homogenous, and it should be noted that it has two attributes (breathes and predator) which were both over 50% shown on the graoh, but as we excluded our filtering to ~80% and above, these are not selected in the filter.</p>
<p>These class members are predicted to have eggs and has_legs. While this limited selection duplicates a few of the previous members that were selected for other classes, this class also contains the invertebrates and insects, which were not present in the other classes.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/eggs_haslegs.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure 4.3.4 Class 5 - 17.09% of the Population</figcaption><p></p>
</figure>
</div>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>Asparouhov, T., &amp; Muthén, B. (2014). Auxiliary variables in mixture modeling: Three-step approaches using Mplus. Structural Equation Modeling: A Multidisciplinary Journal, 21(3), 329–341. <a href="https://doi.org/10.1080/10705511.2014.915181" class="uri">https://doi.org/10.1080/10705511.2014.915181</a></p>
<p>Kaplan, D., Magidson, J., &amp; Vermunt, J. (2004). Chapter 10 Latent Class Models. In The sage handbook of quantitative methodology for the Social Sciences (pp.&nbsp;175–198). essay, SAGE.</p>
<p>Law, E. H., &amp; Harrington, R. (2016). A Primer on Latent Class Analysis. Value &amp; Outcomes Spotlight, NOV/DEC, 18–19. Retrieved April 7, 2023, from <a href="https://www.ispor.org/docs/default-source/publications/value-outcomes-spotlight/november-december-2016/vos-primer-on-latent-class-analysis.pdf?sfvrsn=52b359b7_2" class="uri">https://www.ispor.org/docs/default-source/publications/value-outcomes-spotlight/november-december-2016/vos-primer-on-latent-class-analysis.pdf?sfvrsn=52b359b7_2</a></p>
<p>Martínez Guerrero, M., Ortega Egea, J. M., &amp; Román González, M. V. (2007). Application of the latent class regression methodology to the analysis of internet use for banking transactions in the European Union. Journal of Business Research, 60(2), 137–145. <a href="https://doi.org/10.1016/j.jbusres.2006.10.012" class="uri">https://doi.org/10.1016/j.jbusres.2006.10.012</a></p>
<p>Nylund-Gibson, Karen &amp; Choi, Andrew. (2018). Ten frequently asked questions about latent class analysis. 4. 440-461. <a href="https://doi.org/10.1037/tps0000176" class="uri">https://doi.org/10.1037/tps0000176</a>.</p>
<p>Petersen, K. J., Qualter, P., &amp; Humphrey, N. (2019). The application of latent class analysis for investigating Population Child Mental Health: A systematic review. Frontiers in Psychology, 10. <a href="https://doi.org/10.3389/fpsyg.2019.01214" class="uri">https://doi.org/10.3389/fpsyg.2019.01214</a></p>
<p>Thorpe, J. M., Thorpe, C. T., Kennelty, K. A., &amp; Pandhi, N. (2011). Patterns of perceived barriers to medical care in older adults: A latent class analysis. BMC Health Services Research, 11(1). <a href="https://doi.org/10.1186/1472-6963-11-181" class="uri">https://doi.org/10.1186/1472-6963-11-181</a></p>
<p>Vermunt, J. K. (2010). Latent class modeling with covariates: Two improved three-step approaches. Political Analysis, 18(4), 450–469. <a href="https://doi.org/10.1093/pan/mpq025" class="uri">https://doi.org/10.1093/pan/mpq025</a></p>
<p>Weller, B. E., Bowen, N. K., &amp; Faubert, S. J. (2020). Latent class analysis: A guide to best practice. Journal of Black Psychology, 46(4), 287–311. <a href="https://doi.org/10.1177/0095798420930932" class="uri">https://doi.org/10.1177/0095798420930932</a></p>
<p>Wu, Z., Casciola‐Rosen, L., Rosen, A., &amp; Zeger, S. L. (2020). A bayesian approach to restricted latent class models for scientifically structured clustering of multivariate binary outcomes. Biometrics, 77(4), 1431–1444. <a href="https://doi.org/10.1111/biom.13388" class="uri">https://doi.org/10.1111/biom.13388</a></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>