---
title: "Latent Class Analysis"
format: 
  revealjs:
    transition: slide
    theme: styles.scss
editor: visual
author: "Daniel Martin, Kameron Standhaft, Esra Ari Acar"
---

## Overview

-   What is Latent Class Analysis (LCA)?
-   Usage of LCA
-   Methods
-   Our dataset
-   Our goal
-   Best number of classes
-   Analyze class attributes
-   Correlation
-   Conclusion

## What is Latent Class Analysis (LCA)? {.smaller}

::: panel-tabset
### Definition

-   Latent Class Analysis (LCA) is a probabilistic method of unsupervised clustering that can be utilized when it is believed that there may be unobserved subgroups (classes) among the individuals within a population.

-   The central assumption of LCA model is the presence of latent classes within a population.

-   LCA is a type of finite mixture model (FMM) which is a statistical approach used in unsupervised learning.

-   LCA is a useful model for identifying subgroups within a population based on patterns in **categorical variables**.

-   In LCA, the variables are unrelated within each subgroup but similar across each one.

### Illustration

![Figure 1 - 2 Class Model Representation for LCA [@sinha2021practitioner]](index_files/figure-html/lca_2class_overlap_example.jpg)

### Advantages and Drawback

**Drawback:**

-   LCA is computationally demanding, limiting the number of variables in the analysis

**Advantages:**

-   Identifying hidden subgroups

-   Handling categorical data

-   Providing probability estimates

-   Handling missing data

-   Model selection
:::

## Usage of LCA

## Methods

## Our dataset {.smaller}

::: panel-tabset
### Data Overview

To assess the effectiveness of Latent Class Analysis, we used the 'Zoo Animals' dataset from Kaggle. This dataset has 101 entries and is an ideal choice because of its majority of binary variables.

![](index_files/figure-html/Zoo_Screenshot.png)

### Dropped/Changed Variables {.smaller}

::: columns
::: {.column width="50%"}
**Dropped**

There were 2 variables (Catsize and Domestic) that we dropped because we thought they were subjective. And we dropped the 'Animal' variable because it was an identifier.

![](index_files/figure-html/Dropped_variables.png)
:::

::: {.column width="50%"}
**Changed**

There was one variable in our dataset that was discrete, so we changed it to a binary variable.

<br/><br/>

![](index_files/figure-html/Legs.png)
:::
:::

### Dataset

To perform our analysis, we are using these 14 variables.

![](index_files/figure-html/Variables.png)
:::

## Our goal {.smaller}

We are not including the 'type' variable in our analysis. Instead we are going to use its different categories (mammal, bird, reptile, fish, insects, amphibian, invertebrate) as the classes in our Latent Class Analysis.

```{r}
library(readr)
Zoo_clean <- read_csv("Zoo_clean.csv")

type_table <- table(Zoo_clean$type)

type_prop <- prop.table(type_table)

pie(type_table, labels = paste(names(type_table), formatC(type_prop*100, format = 'f', digits = 1), '%', sep = '\n'))


```

## Best number of classes {.smaller}

::: panel-tabset
### Possible Number of Classes

In order to determine the optimal number of classes that would best model our dataset, we conducted a series of analyses beginning with 2 classes and concluding at 7 classes, which was the number of different types of animals in the dataset. The code presented below was utilized to fit the model for each of the different number of classes.

```{r}
library(tidyverse)

#Creating "has_legs" to denote whether the animal has a leg count >0 from "legs" variable
new_zoo <- Zoo_clean %>% mutate(has_legs = ifelse(legs == 0, 0, 1))

#Removing "legs" since it is continuous and not binary
new_zoo <- new_zoo %>% mutate(legs = NULL)

#Converting has_legs from integer to logical to match the rest of the dataset
new_zoo$has_legs <- as.logical(new_zoo$has_legs)

#Removing "animal","domestic", "catsize", and "type" from 18-variable dataset to make new 14-variable dataset for LCA modeling  
new_zoo_subset <- new_zoo %>% mutate(animal=NULL, domestic=NULL, 
                                     catsize=NULL, type=NULL)

#Creating a dataset where the binary data is converted to integers 0/"FALSE" or 1/"TRUE"
new_zoo_int <- new_zoo_subset %>% mutate_all(~as.integer(.))

#Incrementing the binary integers from 0/1 to 1/2 - poLCA() can only accept integers >=1
new_zoo_int_1 <- new_zoo_int %>% mutate_all(~. + 1)

lca_bind <-  cbind(hair, feathers, eggs, milk, 
                   airborne, aquatic, predator, 
                   toothed, backbone, breathes, 
                   venomous, fins, tail, has_legs) ~ 1
```

```{r, echo=TRUE}

library(poLCA)

lca_fit2 <- poLCA(lca_bind, data = new_zoo_int_1, 
                  nclass = 2, graphs = FALSE, na.rm = TRUE, 
                  nrep=100, maxiter=100, verbose = FALSE)
```

### poLCA Output

The poLCA function has the following options:

-nclass -graphs -na.rm -nrep -maxiter -verbose

![Figure 4.1.1 - LCA 2-Class Model](index_files/figure-html/2_class_model.png)
:::

## Model Comparison Statistics {.smaller}

::: panel-tabset
### AIC & BIC

![LCA Model AIC & BIC Comparison](index_files/figure-html/aic_bic_compare.png)

### Goodness of Fit

![LCA Model GoF Comparison](index_files/figure-html/gof_compare.png)

### Entropy

Entropy is a measure of the concentration in a probability function[@rstudio2021]

We use the poLCA.entropy() function to compare our 5-Class and 6-Class models.

```{r, echo=TRUE, eval=F}

library(poLCA)

lca_fit5.ent <- poLCA.entropy(lca_fit5)
lca_fit6.ent <- poLCA.entropy(lca_fit6)
```

![LCA 5-Class Model](index_files/figure-html/5_6_class_entropy.png)

### Chosen Model

![LCA 5-Class Model](index_files/figure-html/5_class_ordered.png)
:::

## Analyze class attributes

## Correlation {.smaller}

As seen in the correlation heatmap figure below, 'milk' is highly positively correlated with both 'hair' and negatively correlated with 'egg'. We decided to remove 'milk' as an attribute, and re-consider our LCA model to see if it improves without the variables exhibiting this high degree of multicollinearity included.

![Correlation heatmap for sensitivity analysis](index_files/figure-html/Heatmap.png)

## Conclusion {.smaller}

Our research indicates that Latent Class Analysis (LCA) is an exceptionally effective tool at classifying categorical variables based upon their attributes.With larger datasets, and proper screening of models, LCA is a powerful tool for finding group commonalities between members of a group, particularly in disciplines where research is often done through self-reporting and assessment of softer-science categories such as opinion, behavioral observations, and medical research(Kaplan 2004).
